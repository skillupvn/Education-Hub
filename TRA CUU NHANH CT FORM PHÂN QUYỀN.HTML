<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä Tra C·ª©u C√¥ng Th·ª©c T·ª± ƒê·ªông H√≥a - Google Sheets & Apps Script</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 25px;
            animation: slideDown 0.6s ease-out;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1em;
            opacity: 0.95;
        }

        .search-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            animation: slideUp 0.6s ease-out;
        }

        .search-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 12px 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-clear {
            background: #f0f0f0;
            color: #333;
            border: 2px solid #e0e0e0;
            box-shadow: none;
        }

        .btn-clear:hover {
            background: #e8e8e8;
            border-color: #999;
            transform: none;
        }

        .categories-wrapper {
            margin-top: 15px;
        }

        .categories-label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.95em;
        }

        .categories-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 10px;
        }

        .category-btn {
            padding: 10px 12px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
            color: #333;
            text-align: center;
        }

        .category-btn:hover {
            background: #e8e8e8;
            border-color: #667eea;
        }

        .category-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .stats {
            text-align: center;
            color: white;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 18px;
            animation: fadeIn 0.4s ease-out;
        }

        .formula-card {
            background: white;
            border-radius: 12px;
            padding: 18px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border-left: 5px solid #667eea;
            display: flex;
            flex-direction: column;
        }

        .formula-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-left-color: #764ba2;
        }

        .formula-card h3 {
            color: #667eea;
            margin-bottom: 8px;
            font-size: 1.05em;
            word-break: break-word;
        }

        .category-tag {
            display: inline-block;
            background: #f0f0f0;
            color: #667eea;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            margin-bottom: 10px;
            font-weight: 600;
            width: fit-content;
        }

        .formula-card p {
            color: #666;
            margin: 6px 0;
            line-height: 1.5;
            font-size: 0.93em;
        }

        .formula-card strong {
            color: #333;
            font-weight: 600;
        }

        .label {
            color: #667eea;
            font-weight: 600;
            display: block;
            margin-top: 8px;
            margin-bottom: 3px;
            font-size: 0.9em;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 10px;
            margin: 6px 0 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            color: #d63384;
            overflow-x: auto;
            word-break: break-all;
            line-height: 1.4;
        }

        .copy-btn {
            display: inline-block;
            padding: 6px 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            margin-top: 6px;
            margin-right: 6px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .copy-btn:hover {
            background: #764ba2;
        }

        .copy-btn.copied {
            background: #28a745;
        }

        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 50px 20px;
            color: white;
            font-size: 1.2em;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .search-container {
                flex-direction: column;
            }

            .btn, .btn-clear {
                width: 100%;
            }

            .results-section {
                grid-template-columns: 1fr;
            }

            .categories-section {
                grid-template-columns: repeat(2, 1fr);
            }

            .formula-card {
                padding: 15px;
            }
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 40px;
            padding: 20px;
            opacity: 0.9;
            font-size: 0.9em;
        }

        .info-box {
            background: rgba(255,255,255,0.1);
            border-left: 4px solid white;
            padding: 12px 15px;
            border-radius: 6px;
            color: white;
            margin-bottom: 15px;
            font-size: 0.95em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä C√¥ng Th·ª©c T·ª± ƒê·ªông H√≥a Google Sheets & Apps Script</h1>
            <p>Tra c·ª©u nhanh h∆°n 200+ c√¥ng th·ª©c - Sao ch√©p m·ªôt click - D√πng ngay cho d·ª± √°n c·ªßa b·∫°n</p>
        </header>

        <div class="search-section">
            <div class="info-box">
                üí° M·∫πo: T√¨m ki·∫øm theo t√™n c√¥ng th·ª©c ho·∫∑c t·ª´ kh√≥a | Ch·ªçn danh m·ª•c ƒë·ªÉ l·ªçc nhanh | Nh·∫•n "Sao ch√©p" ƒë·ªÉ d√πng ngay
            </div>

            <div class="search-container">
                <input 
                    type="text" 
                    id="searchInput" 
                    class="search-input" 
                    placeholder="üîç T√¨m c√¥ng th·ª©c (l∆∞∆°ng, tu·ªïi, email, t√≠nh to√°n...)">
                <button class="btn" onclick="performSearch()">üîç T√¨m Ki·∫øm</button>
                <button class="btn-clear" onclick="clearSearch()">‚úï X√≥a</button>
            </div>

            <div class="categories-wrapper">
                <span class="categories-label">üìÇ L·ªçc theo nh√≥m:</span>
                <div class="categories-section" id="categoriesSection"></div>
            </div>

            <div class="stats">
                üìà T·ªïng <span id="totalFormulas">0</span> c√¥ng th·ª©c | Hi·ªÉn th·ªã <span id="displayCount">0</span> k·∫øt qu·∫£
            </div>
        </div>

        <div class="results-section" id="resultsSection"></div>

        <div class="footer">
            <p>üöÄ ƒê∆∞·ª£c c·∫≠p nh·∫≠t v·ªõi t·∫•t c·∫£ c√¥ng th·ª©c ch√≠nh th·ª©c | D√πng cho Google Sheets & Google Apps Script</p>
            <p style="margin-top: 10px;">‚ú® Ti·∫øt ki·ªám th·ªùi gian, gi·∫£m sai s√≥t, l√†m vi·ªác chuy√™n nghi·ªáp h∆°n</p>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu c√¥ng th·ª©c to√†n b·ªô t·ª´ t√†i li·ªáu g·ªëc
        const formulas = [
            // NH√ìM 1: C·ª® PH√ÅP C∆† B·∫¢N - PH√âP TO√ÅN
            { category: 'C√∫ ph√°p c∆° b·∫£n', title: 'C·ªông hai gi√° tr·ªã', purpose: 'T√≠nh t·ªïng l∆∞∆°ng', formula: '{L∆∞∆°ng c∆° b·∫£n} + {Ph·ª• c·∫•p}', example: 'C·ªông l∆∞∆°ng c∆° b·∫£n v·ªõi ph·ª• c·∫•p', sheetsFormula: '=A2+B2' },
            { category: 'C√∫ ph√°p c∆° b·∫£n', title: 'Tr·ª´ hai gi√° tr·ªã', purpose: 'T√≠nh l√£i/l·ªó', formula: '{T·ªïng thu} - {T·ªïng chi}', example: 'T√≠nh l√£i/l·ªó trong th√°ng', sheetsFormula: '=A2-B2' },
            { category: 'C√∫ ph√°p c∆° b·∫£n', title: 'Nh√¢n hai gi√° tr·ªã', purpose: 'T√≠nh th√†nh ti·ªÅn', formula: '{S·ªë l∆∞·ª£ng} * {ƒê∆°n gi√°}', example: 'Nh√¢n s·ªë l∆∞·ª£ng v·ªõi ƒë∆°n gi√°', sheetsFormula: '=A2*B2' },
            { category: 'C√∫ ph√°p c∆° b·∫£n', title: 'Chia hai gi√° tr·ªã', purpose: 'T√≠nh trung b√¨nh', formula: '{T·ªïng l∆∞∆°ng} / {S·ªë ng√†y}', example: 'Chia t·ªïng l∆∞∆°ng cho s·ªë ng√†y', sheetsFormula: '=A2/B2' },
            
            // NH√ìM 2: GH√âP CHU·ªñI & ƒê·ªäNH D·∫†NG
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Gh√©p t√™n ƒë·∫ßy ƒë·ªß', purpose: 'T·∫°o t√™n ƒë·∫ßy ƒë·ªß', formula: '{H·ªç} + " " + {T√™n}', example: 'Gh√©p "Nguy·ªÖn" + "VƒÉn A"', sheetsFormula: '=A2&" "&B2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Th√™m ƒë∆°n v·ªã v√†o gi√° tr·ªã', purpose: 'ƒê·ªãnh d·∫°ng gi√° tr·ªã', formula: '{L∆∞∆°ng} + " VNƒê"', example: 'Th√™m "VNƒê" v√†o l∆∞∆°ng', sheetsFormula: '=A2&" VNƒê"' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'T·∫°o ƒë·ªãnh d·∫°ng vƒÉn b·∫£n', purpose: 'Gh√©p th√¥ng tin chi ti·∫øt', formula: '"Nh√¢n vi√™n " + {M√£ NV} + ": " + {H·ªç t√™n}', example: 'T·∫°o d√≤ng "Nh√¢n vi√™n NV001: Nguy·ªÖn VƒÉn A"', sheetsFormula: '="Nh√¢n vi√™n "&A2&": "&B2' },

            // NH√ìM 3: NG√ÄY & GI·ªú
            { category: 'Ng√†y & Gi·ªù', title: 'Ghi ng√†y hi·ªán t·∫°i (C√°ch 1)', purpose: 'L·∫•y ng√†y th√°ng nƒÉm', formula: 'new Date().getDate() + "/" + new Date().getMonth() + "/" + new Date().getFullYear()', example: 'L·∫•y ng√†y h√¥m nay (ƒë·ªãnh d·∫°ng D/M/Y)', sheetsFormula: '=TODAY()' },
            { category: 'Ng√†y & Gi·ªù', title: 'Ghi ng√†y hi·ªán t·∫°i (C√°ch 2)', purpose: 'L·∫•y ng√†y theo ƒë·ªãnh d·∫°ng GB', formula: 'new Date().toLocaleString("en-GB").replace(/,/, "")', example: 'L·∫•y ng√†y gi·ªù hi·ªán t·∫°i', sheetsFormula: '=NOW()' },
            { category: 'Ng√†y & Gi·ªù', title: 'Ng√†y hi·ªán t·∫°i theo VN', purpose: 'ƒê·ªãnh d·∫°ng Vi·ªát Nam', formula: 'new Date().toLocaleDateString("vi-VN")', example: 'L·∫•y ng√†y theo ƒë·ªãnh d·∫°ng VN (dd/mm/yyyy)', sheetsFormula: '=TEXT(TODAY(),"dd/mm/yyyy")' },
            { category: 'Ng√†y & Gi·ªù', title: 'Ng√†y mai', purpose: 'T√≠nh ng√†y ti·∫øp theo', formula: 'new Date(Date.now() + 24*60*60*1000).toLocaleDateString()', example: 'L·∫•y ng√†y mai', sheetsFormula: '=TODAY()+1' },
            { category: 'Ng√†y & Gi·ªù', title: 'Gi·ªù hi·ªán t·∫°i', purpose: 'L·∫•y gi·ªù ph√∫t', formula: 'new Date().getHours() + ":" + new Date().getMinutes().toString().padStart(2, "0")', example: 'L·∫•y gi·ªù hi·ªán t·∫°i (HH:MM)', sheetsFormula: '=TEXT(NOW(),"hh:mm")' },
            { category: 'Ng√†y & Gi·ªù', title: 'Timestamp hi·ªán t·∫°i', purpose: 'L·∫•y mili-gi√¢y t·ª´ 1970', formula: 'Date.now()', example: 'L·∫•y s·ªë mili-gi√¢y hi·ªán t·∫°i', sheetsFormula: '=UNIX_TIMESTAMP()*1000' },
            { category: 'Ng√†y & Gi·ªù', title: 'T√≠nh tu·ªïi', purpose: 'T√≠nh tu·ªïi t·ª´ ng√†y sinh', formula: 'new Date().getFullYear() - new Date({Ng√†y sinh}).getFullYear()', example: 'T√≠nh tu·ªïi c·ªßa nh√¢n vi√™n', sheetsFormula: '=YEAR(TODAY())-YEAR(C2)' },
            { category: 'Ng√†y & Gi·ªù', title: 'T√≠nh s·ªë ng√†y l√†m vi·ªác', purpose: 'T√≠nh th·ªùi gian d·ª± √°n', formula: 'Math.floor(({Ng√†y k·∫øt th√∫c} - {Ng√†y b·∫Øt ƒë·∫ßu}) / (1000*60*60*24))', example: 'T√≠nh s·ªë ng√†y t·ª´ ng√†y b·∫Øt ƒë·∫ßu ƒë·∫øn k·∫øt th√∫c', sheetsFormula: '=D2-C2' },
            { category: 'Ng√†y & Gi·ªù', title: 'T√≠nh s·ªë gi·ªù l√†m vi·ªác', purpose: 'T√≠nh gi·ªù l√†m vi·ªác', formula: '{Gi·ªù k·∫øt th√∫c} - {Gi·ªù b·∫Øt ƒë·∫ßu}', example: 'T√≠nh gi·ªù l√†m t·ª´ s√°ng ƒë·∫øn chi·ªÅu', sheetsFormula: '=D2-C2' },
            { category: 'Ng√†y & Gi·ªù', title: 'T√≠nh th√¢m ni√™n (nƒÉm)', purpose: 'T√≠nh s·ªë nƒÉm l√†m vi·ªác', formula: '(new Date() - new Date({Ng√†y v√†o l√†m})) / (1000*60*60*24*365)', example: 'T√≠nh th√¢m ni√™n l√†m vi·ªác', sheetsFormula: '=(TODAY()-C2)/365' },
            { category: 'Ng√†y & Gi·ªù', title: 'T√≠nh tu·ªïi ngh·ªÅ', purpose: 'T√≠nh nƒÉm kinh nghi·ªám', formula: 'Math.floor((new Date() - new Date({Ng√†y b·∫Øt ƒë·∫ßu ngh·ªÅ})) / (1000*60*60*24*365))', example: 'T√≠nh nƒÉm kinh nghi·ªám trong ng√†nh', sheetsFormula: '=INT((TODAY()-C2)/365)' },
            { category: 'Ng√†y & Gi·ªù', title: 'Th·ªùi gian c√≤n l·∫°i ƒë·∫øn deadline', purpose: 'T√≠nh ng√†y c√≤n l·∫°i', formula: 'Math.ceil(({Deadline} - new Date()) / (1000*60*60*24)) + " ng√†y"', example: 'T√≠nh s·ªë ng√†y ƒë·∫øn deadline', sheetsFormula: '=D2-TODAY()&" ng√†y"' },
            { category: 'Ng√†y & Gi·ªù', title: 'Th√°ng hi·ªán t·∫°i', purpose: 'L·∫•y th√°ng hi·ªán t·∫°i', formula: 'new Date().getMonth() + 1', example: 'L·∫•y s·ªë th√°ng (1-12)', sheetsFormula: '=MONTH(TODAY())' },
            { category: 'Ng√†y & Gi·ªù', title: 'Qu√Ω hi·ªán t·∫°i', purpose: 'L·∫•y qu√Ω nƒÉm nay', formula: '"Q" + Math.ceil((new Date().getMonth() + 1) / 3)', example: 'L·∫•y qu√Ω (Q1, Q2, Q3, Q4)', sheetsFormula: '="Q"&ROUNDUP(MONTH(TODAY())/3,0)' },
            { category: 'Ng√†y & Gi·ªù', title: 'Tu·∫ßn trong nƒÉm', purpose: 'T√≠nh tu·∫ßn th·ª© m·∫•y', formula: 'Math.ceil((new Date() - new Date(new Date().getFullYear(), 0, 1)) / (7*24*60*60*1000))', example: 'T√≠nh tu·∫ßn th·ª© bao nhi√™u trong nƒÉm', sheetsFormula: '=WEEKNUM(TODAY())' },
            { category: 'Ng√†y & Gi·ªù', title: 'NƒÉm t√†i ch√≠nh', purpose: 'T√≠nh nƒÉm t√†i ch√≠nh', formula: 'new Date().getMonth() >= 3 ? new Date().getFullYear() : new Date().getFullYear() - 1', example: 'T√≠nh nƒÉm t√†i ch√≠nh (t·ª´ th√°ng 4)', sheetsFormula: '=IF(MONTH(TODAY())>=4,YEAR(TODAY()),YEAR(TODAY())-1)' },
            { category: 'Ng√†y & Gi·ªù', title: 'H·∫°n thanh to√°n', purpose: 'T√≠nh h·∫°n thanh to√°n', formula: 'new Date(new Date({Ng√†y h√≥a ƒë∆°n}).getTime() + {S·ªë ng√†y} * 24*60*60*1000).toLocaleDateString()', example: 'T√≠nh h·∫°n 30 ng√†y t·ª´ ng√†y h√≥a ƒë∆°n', sheetsFormula: '=C2+D2' },
            { category: 'Ng√†y & Gi·ªù', title: 'Ng√†y ngh·ªâ h∆∞u', purpose: 'T√≠nh ng√†y ngh·ªâ h∆∞u', formula: 'new Date(new Date({Ng√†y sinh}).setFullYear(new Date({Ng√†y sinh}).getFullYear() + 60)).toLocaleDateString()', example: 'T√≠nh ng√†y ngh·ªâ h∆∞u (60 tu·ªïi)', sheetsFormula: '=DATE(YEAR(C2)+60,MONTH(C2),DAY(C2))' },
            { category: 'Ng√†y & Gi·ªù', title: 'Ng√†y cu·ªëi th√°ng', purpose: 'L·∫•y ng√†y cu·ªëi c√πng', formula: 'new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0).getDate()', example: 'L·∫•y ng√†y cu·ªëi c√πng c·ªßa th√°ng', sheetsFormula: '=DAY(DATE(YEAR(TODAY()),MONTH(TODAY())+1,0))' },
            { category: 'Ng√†y & Gi·ªù', title: 'Ng√†y ƒë·∫ßu tu·∫ßn', purpose: 'L·∫•y ng√†y ƒë·∫ßu tu·∫ßn', formula: 'new Date(new Date() - new Date().getDay() * 24*60*60*1000).toLocaleDateString()', example: 'L·∫•y ng√†y th·ª© 2 ƒë·∫ßu tu·∫ßn', sheetsFormula: '=TODAY()-WEEKDAY(TODAY(),2)+1' },

            // NH√ìM 4: L∆Ø∆†NG & THU·∫æ & T√ÄI CH√çNH
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh t·ªïng l∆∞∆°ng', purpose: 'T√≠nh l∆∞∆°ng th√°ng ƒë·∫ßy ƒë·ªß', formula: '{L∆∞∆°ng c∆° b·∫£n} + {Ph·ª• c·∫•p} + {Th∆∞·ªüng}', example: 'Gh√©p l∆∞∆°ng c∆° b·∫£n + ph·ª• c·∫•p + th∆∞·ªüng', sheetsFormula: '=C2+D2+E2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh l∆∞∆°ng sau thu·∫ø', purpose: 'L∆∞∆°ng th·ª±c nh·∫≠n', formula: '{T·ªïng l∆∞∆°ng} - ({T·ªïng l∆∞∆°ng} * 0.1)', example: 'Tr·ª´ 10% thu·∫ø', sheetsFormula: '=C2-(C2*0.1)' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh thu nh·∫≠p th·ª±c', purpose: 'Thu nh·∫≠p sau kh·∫•u tr·ª´', formula: '{L∆∞∆°ng} + {Hoa h·ªìng} - {Kh·∫•u tr·ª´}', example: 'C·ªông l∆∞∆°ng v√† hoa h·ªìng, tr·ª´ kh·∫•u tr·ª´', sheetsFormula: '=C2+D2-E2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh hoa h·ªìng b√°n h√†ng', purpose: 'T√≠nh ti·ªÅn hoa h·ªìng', formula: '{Doanh s·ªë} * {T·ª∑ l·ªá hoa h·ªìng} / 100', example: 'Doanh s·ªë 50M √ó 5% = 2.5M', sheetsFormula: '=C2*D2/100' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh l∆∞∆°ng overtime', purpose: 'T√≠nh ti·ªÅn l√†m th√™m gi·ªù', formula: '{L∆∞∆°ng c∆° b·∫£n} / 30 / 8 * {Gi·ªù tƒÉng ca} * 1.5', example: 'T√≠nh OT v·ªõi h·ªá s·ªë 1.5', sheetsFormula: '=C2/30/8*D2*1.5' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh VAT (10%)', purpose: 'T√≠nh thu·∫ø VAT', formula: '{Th√†nh ti·ªÅn} * 0.1', example: 'T√≠nh VAT 10%', sheetsFormula: '=C2*0.1' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh t·ªïng ti·ªÅn c√≥ VAT', purpose: 'T√≠nh gi√° b√°n', formula: '{Th√†nh ti·ªÅn} + {VAT}', example: 'C·ªông ti·ªÅn g·ªëc + VAT', sheetsFormula: '=C2+D2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh chi·∫øt kh·∫•u', purpose: 'T√≠nh ti·ªÅn gi·∫£m gi√°', formula: '{ƒê∆°n gi√°} * {S·ªë l∆∞·ª£ng} * {T·ª∑ l·ªá CK} / 100', example: 'T√≠nh CK khi mua s·ªâ', sheetsFormula: '=C2*D2*E2/100' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh th√†nh ti·ªÅn sau CK', purpose: 'Gi√° sau chi·∫øt kh·∫•u', formula: '{T·ªïng ti·ªÅn} - {Chi·∫øt kh·∫•u}', example: 'Gi√° sau tr·ª´ chi·∫øt kh·∫•u', sheetsFormula: '=C2-D2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh l√£i su·∫•t h√†ng th√°ng', purpose: 'L√£i su·∫•t th√°ng', formula: '{L√£i su·∫•t nƒÉm} / 12', example: 'Chia l√£i su·∫•t nƒÉm cho 12', sheetsFormula: '=C2/12' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh ti·ªÅn l√£i', purpose: 'T√≠nh ti·ªÅn l√£i sinh', formula: '{S·ªë ti·ªÅn g·ªëc} * {L√£i su·∫•t} / 100', example: 'T√≠nh l√£i ng√¢n h√†ng', sheetsFormula: '=C2*D2/100' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh ROI (%)', purpose: 'ƒê√°nh gi√° hi·ªáu qu·∫£ ƒë·∫ßu t∆∞', formula: '({L·ª£i nhu·∫≠n} - {V·ªën ƒë·∫ßu t∆∞}) / {V·ªën ƒë·∫ßu t∆∞} * 100', example: 'T√≠nh ph·∫ßn trƒÉm l·ª£i nhu·∫≠n', sheetsFormula: '=(C2-D2)/D2*100' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh t·ª∑ l·ªá tƒÉng tr∆∞·ªüng', purpose: 'T√≠nh ph·∫ßn trƒÉm tƒÉng', formula: '({Gi√° tr·ªã hi·ªán t·∫°i} - {Gi√° tr·ªã tr∆∞·ªõc}) / {Gi√° tr·ªã tr∆∞·ªõc} * 100', example: 'T√≠nh tƒÉng tr∆∞·ªüng doanh s·ªë', sheetsFormula: '=(C2-D2)/D2*100' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh gi√° b√°n l·∫ª', purpose: 'ƒê·ªãnh gi√° s·∫£n ph·∫©m', formula: '{Gi√° nh·∫≠p} * (1 + {T·ª∑ l·ªá l·ª£i nhu·∫≠n} / 100)', example: 'Nh·∫≠p 100k, l√£i 30% = 130k', sheetsFormula: '=C2*(1+D2/100)' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh Margin (%)', purpose: 'T√≠nh l·ª£i nhu·∫≠n %', formula: '({Gi√° b√°n} - {Gi√° v·ªën}) / {Gi√° b√°n} * 100', example: 'T√≠nh % l·ª£i nhu·∫≠n tr√™n gi√° b√°n', sheetsFormula: '=(C2-D2)/C2*100' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh ƒëi·ªÉm h√≤a v·ªën', purpose: 'T√≠nh s·ªë s·∫£n ph·∫©m c·∫ßn b√°n', formula: '{Chi ph√≠ c·ªë ƒë·ªãnh} / ({Gi√° b√°n} - {Chi ph√≠ bi·∫øn ƒë·ªïi})', example: 'T√≠nh break-even point', sheetsFormula: '=D2/(C2-E2)' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh ti·∫øt ki·ªám h√†ng th√°ng', purpose: 'T√≠nh ti·ªÅn ti·∫øt ki·ªám', formula: '{Thu nh·∫≠p} - {Chi ph√≠}', example: 'Ti·∫øt ki·ªám = Thu nh·∫≠p - Chi ph√≠', sheetsFormula: '=C2-D2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh ph√≠ v·∫≠n chuy·ªÉn', purpose: 'T√≠nh chi ph√≠ ship', formula: '{Kh·ªëi l∆∞·ª£ng} * {ƒê∆°n gi√° v·∫≠n chuy·ªÉn}', example: 'T√≠nh ph√≠ ship theo kg', sheetsFormula: '=C2*D2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh t·ªïng chi ph√≠', purpose: 'T√≠nh t·ªïng chi ph√≠', formula: '{Chi ph√≠ s·∫£n xu·∫•t} + {Chi ph√≠ v·∫≠n h√†nh} + {Chi ph√≠ kh√°c}', example: 'C·ªông t·∫•t c·∫£ chi ph√≠', sheetsFormula: '=C2+D2+E2' },
            { category: 'L∆∞∆°ng & Thu·∫ø', title: 'T√≠nh kh·∫•u hao', purpose: 'T√≠nh kh·∫•u hao t√†i s·∫£n', formula: '{Gi√° tr·ªã t√†i s·∫£n} / {S·ªë nƒÉm kh·∫•u hao}', example: 'Kh·∫•u hao m√°y m√≥c h√†ng nƒÉm', sheetsFormula: '=C2/D2' },

            // NH√ìM 5: X·ª¨ L√ù VƒÇN B·∫¢N & T·∫†O M√É
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'H·ªç t√™n ƒë·∫ßy ƒë·ªß', purpose: 'T·∫°o t√™n ƒë·∫ßy ƒë·ªß', formula: '{H·ªç} + " " + {T√™n}', example: 'Gh√©p h·ªç v√† t√™n', sheetsFormula: '=C2&" "&D2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'T√™n vi·∫øt t·∫Øt', purpose: 'T·∫°o ch·ªØ c√°i ƒë·∫ßu', formula: '{H·ªç}.charAt(0) + {T√™n}.charAt(0)', example: 'Nguy·ªÖn VƒÉn A ‚Üí NA', sheetsFormula: '=LEFT(C2,1)&LEFT(D2,1)' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'T√™n hi·ªÉn th·ªã', purpose: 'Gh√©p ch·ª©c v·ª• v√† t√™n', formula: '{Ch·ª©c v·ª•} + " " + {H·ªç t√™n}', example: 'Gi√°m ƒë·ªëc Nguy·ªÖn VƒÉn A', sheetsFormula: '=C2&" "&D2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'T·∫°o username', purpose: 'T·∫°o t√™n ƒëƒÉng nh·∫≠p', formula: '{T√™n}.toLowerCase().replace(/\\s+/g, "") + {NƒÉm sinh}', example: '"van a1990" ‚Üí "vana1990"', sheetsFormula: '=LOWER(SUBSTITUTE(C2," ",""))&D2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M√£ nh√¢n vi√™n', purpose: 'T·∫°o m√£ NV chu·∫©n', formula: '"NV" + {ID}.toString().padStart(4, "0")', example: 'ID=15 ‚Üí NV0015', sheetsFormula: '="NV"&TEXT(C2,"0000")' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M√£ ƒë∆°n h√†ng', purpose: 'T·∫°o m√£ ƒë∆°n', formula: '"DH" + new Date().getFullYear() + {ID}.toString().padStart(6, "0")', example: 'DH2025000123', sheetsFormula: '="DH"&YEAR(TODAY())&TEXT(C2,"000000")' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M√£ s·∫£n ph·∫©m', purpose: 'T·∫°o m√£ SP', formula: '{Lo·∫°i}.substring(0,2).toUpperCase() + "-" + {ID}', example: '"laptop" ‚Üí LA-123', sheetsFormula: '=UPPER(LEFT(C2,2))&"-"&D2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M√£ kh√°ch h√†ng', purpose: 'T·∫°o m√£ KH', formula: '"KH" + {Th√†nh ph·ªë}.substring(0,2).toUpperCase() + {ID}', example: 'KHHN001 (H√† N·ªôi)', sheetsFormula: '="KH"&UPPER(LEFT(C2,2))&D2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M√£ QR', purpose: 'T·∫°o m√£ QR', formula: '"QR_" + {ID} + "_" + Date.now()', example: 'QR_123_1705334400000', sheetsFormula: '="QR_"&C2&"_"&UNIX_TIMESTAMP()*1000' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M√£ barcode', purpose: 'T·∫°o m√£ v·∫°ch', formula: '{Lo·∫°i}.substring(0,3) + Date.now().toString().slice(-6)', example: 'LAP400000', sheetsFormula: '=LEFT(C2,3)&RIGHT(TEXT(NOW(),"000000000000"),6)' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Email c√¥ng ty', purpose: 'T·∫°o email', formula: '{T√™n}.toLowerCase() + "@company.com"', example: '"vana@company.com"', sheetsFormula: '=LOWER(SUBSTITUTE(C2," ",""))&"@company.com"' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Format s·ªë ƒëi·ªán tho·∫°i', purpose: 'ƒê·ªãnh d·∫°ng SƒêT', formula: '{SƒêT}.replace(/(\\d{4})(\\d{3})(\\d{3})/, "$1-$2-$3")', example: '"0123456789" ‚Üí "0123-456-789"', sheetsFormula: '=TEXT(C2,"0000-000-000")' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'ƒê·ªãa ch·ªâ ƒë·∫ßy ƒë·ªß', purpose: 'Gh√©p ƒë·ªãa ch·ªâ', formula: '{S·ªë nh√†} + " " + {ƒê∆∞·ªùng} + ", " + {Qu·∫≠n} + ", " + {Th√†nh ph·ªë}', example: '123 Nguy·ªÖn Tr√£i, Q.1, TP.HCM', sheetsFormula: '=C2&" "&D2&", "&E2&", "&F2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Signature', purpose: 'T·∫°o ch·ªØ k√Ω', formula: '{H·ªç t√™n} + " - " + {Ch·ª©c v·ª•} + " | " + {C√¥ng ty}', example: 'Nguy·ªÖn VƒÉn A - Gƒê | ABC Corp', sheetsFormula: '=C2&" - "&D2&" | "&E2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'T√™n file', purpose: 'T·∫°o t√™n file', formula: '{T√™n d·ª± √°n} + "_" + new Date().toISOString().slice(0,10) + ".pdf"', example: 'DuAn_2025-12-15.pdf', sheetsFormula: '=C2&"_"&TEXT(TODAY(),"yyyy-mm-dd")&".pdf"' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'ƒê∆∞·ªùng d·∫´n file', purpose: 'T·∫°o ƒë∆∞·ªùng d·∫´n', formula: '"/uploads/" + {NƒÉm} + "/" + {Th√°ng} + "/" + {T√™n file}', example: '/uploads/2025/12/file.pdf', sheetsFormula: '="/uploads/"&C2&"/"&TEXT(D2,"00")&"/"&E2' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Ti√™u ƒë·ªÅ b√°o c√°o', purpose: 'T·∫°o ti√™u ƒë·ªÅ', formula: '"B√°o c√°o " + {Lo·∫°i BC} + " th√°ng " + new Date().getMonth()', example: 'B√°o c√°o Doanh Thu th√°ng 12', sheetsFormula: '="B√°o c√°o "&C2&" th√°ng "&MONTH(TODAY())' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Ghi ch√∫ t·ª± ƒë·ªông', purpose: 'T·∫°o ghi ch√∫', formula: '"T·∫°o b·ªüi " + {Ng∆∞·ªùi t·∫°o} + " l√∫c " + new Date().toLocaleDateString()', example: 'T·∫°o b·ªüi Admin l√∫c 15/12/2025', sheetsFormula: '="T·∫°o b·ªüi "&C2&" l√∫c "&TEXT(TODAY(),"dd/mm/yyyy")' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'Hashtag', purpose: 'T·∫°o hashtag', formula: '"#" + {T·ª´ kh√≥a}.toLowerCase().replace(/\\s+/g, "")', example: '#GoogleSheets', sheetsFormula: '="#"&LOWER(SUBSTITUTE(C2," ",""))' },
            { category: 'X·ª≠ l√Ω vƒÉn b·∫£n', title: 'M·∫≠t kh·∫©u t·∫°m', purpose: 'T·∫°o m·∫≠t kh·∫©u', formula: '{T√™n}.substring(0,3) + Math.floor(Math.random()*1000)', example: 'Vana789', sheetsFormula: '=LEFT(C2,3)&RANDBETWEEN(0,999)' },

            // NH√ìM 6: LOGIC & ƒêI·ªÄU KI·ªÜN
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Ki·ªÉm tra thanh to√°n', purpose: 'T·ª± ƒë·ªông c·∫≠p nh·∫≠t tr·∫°ng th√°i', formula: '{S·ªë ti·ªÅn ƒë√£ tr·∫£} >= {T·ªïng ti·ªÅn} ? "ƒê√£ thanh to√°n" : "Ch∆∞a thanh to√°n"', example: 'Ki·ªÉm tra xem ƒë√£ thanh to√°n ƒë·ªß ch∆∞a', sheetsFormula: '=IF(C2>=D2,"ƒê√£ thanh to√°n","Ch∆∞a thanh to√°n")' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Ki·ªÉm tra h·ª£p l·ªá h√≥a ƒë∆°n', purpose: 'Ki·ªÉm tra th·ªùi h·∫°n', formula: '{Ng√†y h·∫øt h·∫°n} < new Date() ? "Qu√° h·∫°n" : "C√≤n hi·ªáu l·ª±c"', example: 'Ki·ªÉm tra h√≥a ƒë∆°n c√≤n h·∫°n kh√¥ng', sheetsFormula: '=IF(C2<TODAY(),"Qu√° h·∫°n","C√≤n hi·ªáu l·ª±c")' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Ki·ªÉm tra ph√™ duy·ªát', purpose: 'T·ª± ƒë·ªông ph√™ duy·ªát', formula: '{S·ªë ti·ªÅn} > 10000000 ? "C·∫ßn ph√™ duy·ªát c·∫•p cao" : "T·ª± ph√™ duy·ªát"', example: 'Ph√™ duy·ªát n·∫øu > 10M', sheetsFormula: '=IF(C2>10000000,"C·∫ßn ph√™ duy·ªát c·∫•p cao","T·ª± ph√™ duy·ªát")' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Chi·∫øt kh·∫•u VIP', purpose: '∆Øu ƒë√£i kh√°ch h√†ng VIP', formula: '{Lo·∫°i KH} === "VIP" ? {T·ªïng ti·ªÅn} * 0.1 : 0', example: 'Gi·∫£m 10% cho KH VIP', sheetsFormula: '=IF(C2="VIP",D2*0.1,0)' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'X·∫øp lo·∫°i ƒëi·ªÉm', purpose: 'Ph√¢n lo·∫°i k·∫øt qu·∫£', formula: '{ƒêi·ªÉm} >= 9 ? "Xu·∫•t s·∫Øc" : {ƒêi·ªÉm} >= 8 ? "Gi·ªèi" : {ƒêi·ªÉm} >= 7 ? "Kh√°" : "Trung b√¨nh"', example: 'X·∫øp lo·∫°i t·ª´ 7-10 ƒëi·ªÉm', sheetsFormula: '=IF(C2>=9,"Xu·∫•t s·∫Øc",IF(C2>=8,"Gi·ªèi",IF(C2>=7,"Kh√°","Trung b√¨nh")))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Tr·∫°ng th√°i h·ªçc t·∫≠p', purpose: 'ƒê√°nh gi√° h·ªçc sinh', formula: '{ƒêi·ªÉm trung b√¨nh} >= 8.5 ? "H·ªçc sinh gi·ªèi" : {ƒêi·ªÉm trung b√¨nh} >= 6.5 ? "H·ªçc sinh kh√°" : "H·ªçc sinh trung b√¨nh"', example: 'Ph√¢n lo·∫°i h·ªçc sinh', sheetsFormula: '=IF(C2>=8.5,"Gi·ªèi",IF(C2>=6.5,"Kh√°","Trung b√¨nh"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'ƒê√°nh gi√° hi·ªáu su·∫•t', purpose: 'ƒê√°nh gi√° KPI', formula: '{KPI} >= 100 ? "V∆∞·ª£t m·ª•c ti√™u" : {KPI} >= 80 ? "ƒê·∫°t m·ª•c ti√™u" : "Ch∆∞a ƒë·∫°t"', example: 'ƒê√°nh gi√° KPI nh√¢n vi√™n', sheetsFormula: '=IF(C2>=100,"V∆∞·ª£t m·ª•c ti√™u",IF(C2>=80,"ƒê·∫°t m·ª•c ti√™u","Ch∆∞a ƒë·∫°t"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'M·ª©c ƒë·ªô r·ªßi ro', purpose: 'ƒê√°nh gi√° r·ªßi ro', formula: '{ƒêi·ªÉm t√≠n d·ª•ng} < 600 ? "Cao" : {ƒêi·ªÉm t√≠n d·ª•ng} < 750 ? "Trung b√¨nh" : "Th·∫•p"', example: 'Ph√¢n lo·∫°i r·ªßi ro t√≠n d·ª•ng', sheetsFormula: '=IF(C2<600,"Cao",IF(C2<750,"Trung b√¨nh","Th·∫•p"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Ph√¢n lo·∫°i kh√°ch h√†ng', purpose: 'X·∫øp h·∫°ng kh√°ch h√†ng', formula: '{Doanh s·ªë} >= 100000000 ? "VIP" : {Doanh s·ªë} >= 50000000 ? "Th√¢n thi·∫øt" : "Th∆∞·ªùng"', example: 'Ph√¢n lo·∫°i VIP n·∫øu doanh s·ªë >= 100M', sheetsFormula: '=IF(C2>=100000000,"VIP",IF(C2>=50000000,"Th√¢n thi·∫øt","Th∆∞·ªùng"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Level nh√¢n vi√™n', purpose: 'Ph√¢n c·∫•p nh√¢n vi√™n', formula: '{Kinh nghi·ªám} >= 5 ? "Senior" : {Kinh nghi·ªám} >= 2 ? "Middle" : "Junior"', example: 'Ph√¢n c·∫•p: Senior/Middle/Junior', sheetsFormula: '=IF(C2>=5,"Senior",IF(C2>=2,"Middle","Junior"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'M·ª©c l∆∞∆°ng', purpose: 'Ph√¢n lo·∫°i l∆∞∆°ng', formula: '{Ch·ª©c v·ª•} === "Gi√°m ƒë·ªëc" ? "C·∫•p 1" : {Ch·ª©c v·ª•} === "Tr∆∞·ªüng ph√≤ng" ? "C·∫•p 2" : "C·∫•p 3"', example: 'X·∫øp c·∫•p l∆∞∆°ng theo ch·ª©c v·ª•', sheetsFormula: '=IF(C2="Gi√°m ƒë·ªëc","C·∫•p 1",IF(C2="Tr∆∞·ªüng ph√≤ng","C·∫•p 2","C·∫•p 3"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'C·∫£nh b√°o t·ªìn kho', purpose: 'Qu·∫£n l√Ω kho', formula: '{S·ªë l∆∞·ª£ng t·ªìn} < {M·ª©c t·ªëi thi·ªÉu} ? "‚ö†Ô∏è S·∫Øp h·∫øt h√†ng" : "‚úÖ ƒê·ªß h√†ng"', example: 'C·∫£nh b√°o khi t·ªìn < ng∆∞·ª°ng', sheetsFormula: '=IF(C2<D2,"‚ö†Ô∏è S·∫Øp h·∫øt","‚úÖ ƒê·ªß h√†ng")' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'ƒê·ªô ∆∞u ti√™n c√¥ng vi·ªác', purpose: 'X·∫øp ∆∞u ti√™n', formula: '{M·ª©c ƒë·ªô kh·∫©n c·∫•p} === "Cao" ? "üî¥ Kh·∫©n c·∫•p" : {M·ª©c ƒë·ªô kh·∫©n c·∫•p} === "Trung b√¨nh" ? "üü° B√¨nh th∆∞·ªùng" : "üü¢ Th·∫•p"', example: 'ƒê√°nh d·∫•u ∆∞u ti√™n b·∫±ng m√†u', sheetsFormula: '=IF(C2="Cao","üî¥ Kh·∫©n",IF(C2="TB","üü° TB","üü¢ Th·∫•p"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Tr·∫°ng th√°i d·ª± √°n', purpose: 'Theo d√µi ti·∫øn ƒë·ªô', formula: '{Ti·∫øn ƒë·ªô} === 100 ? "Ho√†n th√†nh" : {Ti·∫øn ƒë·ªô} >= 80 ? "S·∫Øp xong" : "ƒêang th·ª±c hi·ªán"', example: 'Hi·ªÉn th·ªã tr·∫°ng th√°i d·ª± √°n', sheetsFormula: '=IF(C2=100,"Ho√†n th√†nh",IF(C2>=80,"S·∫Øp xong","ƒêang l√†m"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Tr·∫°ng th√°i ƒë∆°n h√†ng', purpose: 'Theo d√µi ƒë∆°n h√†ng', formula: '{Ng√†y giao} ? "ƒê√£ giao" : {Ng√†y x·ª≠ l√Ω} ? "ƒêang x·ª≠ l√Ω" : "Ch·ªù x·ª≠ l√Ω"', example: 'Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë∆°n h√†ng', sheetsFormula: '=IF(C2<>"","ƒê√£ giao",IF(D2<>"","ƒêang x·ª≠ l√Ω","Ch·ªù x·ª≠ l√Ω"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Gi·ªõi t√≠nh (anh/ch·ªã)', purpose: 'X∆∞ng h√¥ ph√π h·ª£p', formula: '{Gi·ªõi t√≠nh} === "Nam" ? "Anh" : "Ch·ªã"', example: 'X∆∞ng h√¥ theo gi·ªõi t√≠nh', sheetsFormula: '=IF(C2="Nam","Anh","Ch·ªã")' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'T√≠nh OT t·ª± ƒë·ªông', purpose: 'T√≠nh l∆∞∆°ng OT', formula: '{Gi·ªù l√†m} > 8 ? ({Gi·ªù l√†m} - 8) * {L∆∞∆°ng gi·ªù} * 1.5 : 0', example: 'T√≠nh OT n·∫øu > 8 gi·ªù', sheetsFormula: '=IF(C2>8,(C2-8)*D2*1.5,0)' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'T√¨nh tr·∫°ng s·ª©c kh·ªèe', purpose: 'Ph√¢n lo·∫°i chƒÉm s√≥c', formula: '{Tu·ªïi} > 60 ? "C·∫ßn chƒÉm s√≥c ƒë·∫∑c bi·ªát" : "B√¨nh th∆∞·ªùng"', example: 'C·∫ßn chƒÉm s√≥c n·∫øu > 60 tu·ªïi', sheetsFormula: '=IF(C2>60,"ChƒÉm s√≥c ƒë·∫∑c bi·ªát","B√¨nh th∆∞·ªùng")' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'Ph√¢n ca l√†m vi·ªác', purpose: 'X·∫øp ca l√†m vi·ªác', formula: '{Gi·ªù v√†o} < 12 ? "Ca s√°ng" : {Gi·ªù v√†o} < 18 ? "Ca chi·ªÅu" : "Ca t·ªëi"', example: 'Ph√¢n lo·∫°i ca: s√°ng/chi·ªÅu/t·ªëi', sheetsFormula: '=IF(C2<12,"Ca s√°ng",IF(C2<18,"Ca chi·ªÅu","Ca t·ªëi"))' },
            { category: 'Logic & ƒêi·ªÅu ki·ªán', title: 'T√¨nh tr·∫°ng b·∫£o h√†nh', purpose: 'Ki·ªÉm tra b·∫£o h√†nh', formula: 'new Date() < new Date({Ng√†y mua h√†ng}).setFullYear(new Date({Ng√†y mua h√†ng}).getFullYear() + 1) ? "C√≤n b·∫£o h√†nh" : "H·∫øt b·∫£o h√†nh"', example: 'Ki·ªÉm tra b·∫£o h√†nh 1 nƒÉm', sheetsFormula: '=IF(TODAY()<C2+365,"C√≤n b·∫£o h√†nh","H·∫øt b·∫£o h√†nh")' },

            // NH√ìM 7: TO√ÅN H·ªåC & TH·ªêNG K√ä
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'T·ª∑ l·ªá ho√†n th√†nh', purpose: 'T√≠nh ph·∫ßn trƒÉm ho√†n th√†nh', formula: 'Math.round({Ho√†n th√†nh} / {T·ªïng c√¥ng vi·ªác} * 100) + "%"', example: 'T√≠nh 75% c√¥ng vi·ªác', sheetsFormula: '=ROUND(C2/D2*100,0)&"%"' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'T·ª∑ l·ªá tƒÉng tr∆∞·ªüng (%)', purpose: 'T√≠nh ph·∫ßn trƒÉm tƒÉng', formula: 'Math.round(({Hi·ªán t·∫°i} - {Tr∆∞·ªõc ƒë√≥}) / {Tr∆∞·ªõc ƒë√≥} * 100) + "%"', example: 'T√≠nh tƒÉng tr∆∞·ªüng doanh s·ªë', sheetsFormula: '=ROUND((C2-D2)/D2*100,0)&"%"' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'Hi·ªáu su·∫•t m√°y', purpose: 'T√≠nh hi·ªáu su·∫•t', formula: 'Math.round({Th·ªùi gian ho·∫°t ƒë·ªông} / {T·ªïng th·ªùi gian} * 100) + "%"', example: 'T√≠nh % ho·∫°t ƒë·ªông c·ªßa m√°y', sheetsFormula: '=ROUND(C2/D2*100,0)&"%"' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'Productivity score', purpose: 'T√≠nh ƒëi·ªÉm nƒÉng su·∫•t', formula: 'Math.round({C√¥ng vi·ªác ho√†n th√†nh} / {C√¥ng vi·ªác giao} * 100)', example: 'T√≠nh % c√¥ng vi·ªác ho√†n th√†nh', sheetsFormula: '=ROUND(C2/D2*100,0)' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi', purpose: 'T√≠nh % ch·ªët ƒë∆°n', formula: 'Math.round({S·ªë ƒë∆°n th√†nh c√¥ng} / {T·ªïng leads} * 100) + "%"', example: 'T√≠nh 10% t·ª∑ l·ªá ch·ªët ƒë∆°n', sheetsFormula: '=ROUND(C2/D2*100,0)&"%"' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'T·ª∑ l·ªá l·ªói', purpose: 'T√≠nh ph·∫ßn trƒÉm l·ªói', formula: 'Math.round({S·ªë l·ªói} / {T·ªïng s·∫£n ph·∫©m} * 100) + "%"', example: 'T√≠nh % l·ªói s·∫£n ph·∫©m', sheetsFormula: '=ROUND(C2/D2*100,0)&"%"' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'ƒêi·ªÉm trung b√¨nh', purpose: 'T√≠nh ƒëi·ªÉm TB', formula: '({ƒêi·ªÉm 1} + {ƒêi·ªÉm 2} + {ƒêi·ªÉm 3}) / 3', example: 'T√≠nh ƒëi·ªÉm TB 3 b√†i', sheetsFormula: '=(C2+D2+E2)/3' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'Ch·ªâ s·ªë BMI', purpose: 'T√≠nh ch·ªâ s·ªë BMI', formula: 'Math.round({C√¢n n·∫∑ng} / Math.pow({Chi·ªÅu cao}/100, 2) * 100) / 100', example: 'T√≠nh BMI t·ª´ c√¢n n·∫∑ng & chi·ªÅu cao', sheetsFormula: '=ROUND(C2/POWER(D2/100,2),1)' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'Ch·ªâ s·ªë h√†i l√≤ng', purpose: 'T√≠nh ƒëi·ªÉm h√†i l√≤ng', formula: 'Math.round({T·ªïng ƒëi·ªÉm} / {S·ªë ph·∫£n h·ªìi} * 10) / 10', example: 'T√≠nh 4.5/5 ƒëi·ªÉm h√†i l√≤ng', sheetsFormula: '=ROUND(C2/D2,1)' },
            { category: 'To√°n h·ªçc & Th·ªëng k√™', title: 'ƒê·ªô l·ªách chu·∫©n', purpose: 'T√≠nh ƒë·ªô l·ªách', formula: 'Math.sqrt(Math.pow({Gi√° tr·ªã} - {Trung b√¨nh}, 2) / {S·ªë m·∫´u})', example: 'T√≠nh ƒë·ªô l·ªách chu·∫©n d·ªØ li·ªáu', sheetsFormula: '=STDEV(C2:E2)' },

            // NH√ìM 8: M√É & SERIAL & KH√ÅC
            { category: 'M√£ & Serial', title: 'M√£ v·∫°ch s·∫£n ph·∫©m', purpose: 'T·∫°o m√£ v·∫°ch', formula: '{M√£ lo·∫°i} + Date.now().toString().slice(-8)', example: 'T·∫°o m√£ v·∫°ch duy nh·∫•t', sheetsFormula: '=C2&TEXT(NOW(),"00000000")' },
            { category: 'M√£ & Serial', title: 'Serial number', purpose: 'T·∫°o s·ªë seri', formula: '{NƒÉm s·∫£n xu·∫•t}.toString().slice(-2) + {Th√°ng}.toString().padStart(2, "0") + {ID}.toString().padStart(6, "0")', example: '2312000123', sheetsFormula: '=TEXT(C2,"YY")&TEXT(D2,"00")&TEXT(E2,"000000")' },
            { category: 'M√£ & Serial', title: 'License key', purpose: 'T·∫°o kh√≥a c·∫•p ph√©p', formula: '{Prefix} + "-" + Math.random().toString(36).substring(2, 8).toUpperCase()', example: 'ABC-D3F5G8', sheetsFormula: '=C2&"-"&CONCATENATE(CHAR(RANDBETWEEN(65,90)),CHAR(RANDBETWEEN(65,90)))' },
            { category: 'M√£ & Serial', title: 'Checksum', purpose: 'T·∫°o m√£ ki·ªÉm tra', formula: '{Chu·ªói d·ªØ li·ªáu}.split("").reduce((a,b) => a + b.charCodeAt(0), 0) % 1000', example: 'T·∫°o m√£ ki·ªÉm tra cho d·ªØ li·ªáu', sheetsFormula: '=MOD(SUMPRODUCT(SEARCH(MID(C2,ROW(INDIRECT("1:"&LEN(C2))),1),C2)),1000)' },
            { category: 'M√£ & Serial', title: 'Version software', purpose: 'T·∫°o phi√™n b·∫£n', formula: '{Major} + "." + {Minor} + "." + {Patch}', example: '1.2.3', sheetsFormula: '=C2&"."&D2&"."&E2' },
            { category: 'M√£ & Serial', title: 'API endpoint', purpose: 'T·∫°o ƒë∆∞·ªùng d·∫´n API', formula: '"/api/v1/" + {Resource} + "/" + {ID}', example: '/api/v1/users/123', sheetsFormula: '="/api/v1/"&C2&"/"&D2' },
            { category: 'M√£ & Serial', title: 'Color code', purpose: 'T·∫°o m√£ m√†u', formula: '"#" + Math.floor(Math.random()*16777215).toString(16).padStart(6, "0")', example: '#FF5733', sheetsFormula: '="#"&DEC2HEX(RANDBETWEEN(0,16777215),6)' },
            { category: 'M√£ & Serial', title: 'UUID', purpose: 'T·∫°o ID duy nh·∫•t to√†n c·∫ßu', formula: '"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, c => (c=="x"?Math.random()*16|0:(Math.random()*16|0&0x3|0x8)).toString(16))', example: '550e8400-e29b-41d4-a716-446655440000', sheetsFormula: 'D√πng GOOGLE SHEETS kh√¥ng h·ªó tr·ª£' },
            { category: 'M√£ & Serial', title: 'GPS coordinates', purpose: 'T·∫°o t·ªça ƒë·ªô GPS', formula: '{Vƒ© ƒë·ªô} + "," + {Kinh ƒë·ªô}', example: '10.762622, 106.660172', sheetsFormula: '=C2&", "&D2' },
            { category: 'M√£ & Serial', title: 'QR data (vCard)', purpose: 'T·∫°o d·ªØ li·ªáu QR', formula: '"BEGIN:VCARD FN:" + {H·ªç t√™n} + " TEL:" + {SƒêT} + " EMAIL:" + {Email} + " END:VCARD"', example: 'D·ªØ li·ªáu vCard cho QR code', sheetsFormula: '="BEGIN:VCARD FN:"&C2&" TEL:"&D2&" EMAIL:"&E2&" END:VCARD"' }
        ];

        let currentCategory = 'all';
        let searchTerm = '';

        // H√†m kh·ªüi t·∫°o
        function init() {
            displayCategories();
            displayFormulas(formulas);
            document.getElementById('totalFormulas').textContent = formulas.length;
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') performSearch();
            });
        }

        // Hi·ªÉn th·ªã danh m·ª•c
        function displayCategories() {
            const categories = [...new Set(formulas.map(f => f.category))];
            const section = document.getElementById('categoriesSection');
            
            let html = '<button class="category-btn active" onclick="filterByCategory(\'all\')">T·∫•t C·∫£</button>';
            categories.forEach(cat => {
                html += `<button class="category-btn" onclick="filterByCategory('${cat}')">üìÇ ${cat}</button>`;
            });
            section.innerHTML = html;
        }

        // Hi·ªÉn th·ªã c√¥ng th·ª©c
        function displayFormulas(toDisplay) {
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.innerHTML = '';

            if (toDisplay.length === 0) {
                resultsSection.innerHTML = '<div class="no-results">üòï Kh√¥ng t√¨m th·∫•y c√¥ng th·ª©c. H√£y th·ª≠ t·ª´ kh√≥a kh√°c!</div>';
                document.getElementById('displayCount').textContent = '0';
                return;
            }

            toDisplay.forEach(formula => {
                const card = document.createElement('div');
                card.className = 'formula-card';
                card.innerHTML = `
                    <span class="category-tag">üìÇ ${formula.category}</span>
                    <h3>üî∑ ${formula.title}</h3>
                    <p><span class="label">M·ª•c ƒë√≠ch:</span> ${formula.purpose}</p>
                    <p><span class="label">Apps Script:</span></p>
                    <div class="code-block" onclick="copyFormula(this)">${escapeHtml(formula.formula)}</div>
                    <p><span class="label">Google Sheets:</span></p>
                    <div class="code-block" onclick="copyFormula(this)">${escapeHtml(formula.sheetsFormula)}</div>
                    <p><span class="label">V√≠ d·ª•:</span> ${formula.example}</p>
                    <button class="copy-btn" onclick="copyToClipboard('${escapeHtml(formula.formula)}', this)">üìã Sao ch√©p Apps Script</button>
                    <button class="copy-btn" onclick="copyToClipboard('${escapeHtml(formula.sheetsFormula)}', this)">üìã Sao ch√©p Sheets</button>
                `;
                resultsSection.appendChild(card);
            });

            document.getElementById('displayCount').textContent = toDisplay.length;
        }

        // Sao ch√©p b·∫±ng click v√†o code block
        function copyFormula(element) {
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const originalBg = element.style.background;
                element.style.background = '#d4edda';
                setTimeout(() => {
                    element.style.background = originalBg;
                }, 300);
            });
        }

        // L·ªçc theo danh m·ª•c
        function filterByCategory(category) {
            currentCategory = category;
            searchTerm = '';
            document.getElementById('searchInput').value = '';

            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            const filtered = category === 'all' 
                ? formulas 
                : formulas.filter(f => f.category === category);
            
            displayFormulas(filtered);
        }

        // T√¨m ki·∫øm
        function performSearch() {
            searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (!searchTerm) {
                filterByCategory(currentCategory);
                return;
            }

            const filtered = formulas.filter(f => 
                f.title.toLowerCase().includes(searchTerm) ||
                f.purpose.toLowerCase().includes(searchTerm) ||
                f.example.toLowerCase().includes(searchTerm) ||
                f.formula.toLowerCase().includes(searchTerm) ||
                f.category.toLowerCase().includes(searchTerm)
            );

            displayFormulas(filtered);
        }

        // X√≥a t√¨m ki·∫øm
        function clearSearch() {
            document.getElementById('searchInput').value = '';
            currentCategory = 'all';
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.category-btn').classList.add('active');
            displayFormulas(formulas);
        }

        // Sao ch√©p v√†o clipboard
        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(unescapeHtml(text)).then(() => {
                const originalText = button.textContent;
                button.textContent = '‚úÖ ƒê√£ sao ch√©p!';
                button.classList.add('copied');

                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                }, 1500);
            }).catch(err => {
                alert('L·ªói sao ch√©p: ' + err);
            });
        }

        // Escape HTML
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // Unescape HTML
        function unescapeHtml(text) {
            const map = {
                '&amp;': '&',
                '&lt;': '<',
                '&gt;': '>',
                '&quot;': '"',
                '&#039;': "'"
            };
            return text.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g, m => map[m]);
        }

        // Kh·ªüi t·∫°o
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
